<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="css/mui.min.css" rel="stylesheet" />
		<!--这个是图标库-->
		<link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_808468_a2lnshq3a69.css" />
		<link rel="stylesheet" href="css/style.css" />
		<link rel="stylesheet" type="text/css" href="css/mui.picker.css" />
		<link rel="stylesheet" type="text/css" href="css/mui.poppicker.css" />
		<link rel="stylesheet" type="text/css" href="css/mui.dtpicker.css" />
		<script src="js/rem.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jquery-1.11.1.min.js" type="text/javascript" charset="utf-8"></script>
		<!--弹出层-->
		<link rel="stylesheet" type="text/css" href="css/mui.picker.css" />
		<link rel="stylesheet" type="text/css" href="css/mui.poppicker.css" />
		<link rel="stylesheet" type="text/css" href="css/mui.dtpicker.css" />
		<style type="text/css">
			.leave_add .notice {
				width: 100%;
				padding: 0rem;
				padding-top: 1.5rem;
				background-color: #F6F6FA;
				text-align: center;
			}
			
			.notice #tijiao {
				width: 92%;
			}
			
			.notice .gray {
				background-color: #F5F5F9;
				height: 0.4rem;
				overflow: hidden;
				text-align: left;
			}
			
			.notice .gray.zi {
				height: 0.9rem;
				line-height: 1.2rem;
				padding: 0rem 0.3rem;
				font-size: 0.3rem;
				color: #959595;
			}
			
			.notice .leave_ul {
				display: block;
				padding: 0rem;
				margin: 0rem;
				padding-left: 0.3rem;
				list-style: none;
				background-color: #FFFFFF;
				border-top: 1px solid #CCCCCC;
				border-bottom: 1px solid #CCCCCC;
			}
			
			.notice .leave_ul .leave_li {
				border-bottom: 1px solid #CCCCCC;
				display: block;
				padding: 0rem;
				margin: 0rem;
				height: 1rem;
				line-height: 1rem;
				font-size: 0.3rem;
			}
			
			.notice .leave_ul .leave_li:last-child {
				border: none;
			}
			
			.notice .leave_ul .leave_li .left {
				float: left;
				width: 28%;
				text-align: left;
			}
			
			.notice .leave_ul .leave_li .input {
				display: block;
				margin-left: 28%;
				padding: 0rem;
				margin: 0rem;
				width: 70%;
				border: none;
				outline: none;
				height: 98%;
				font-size: 0.3rem;
				color: #262626;
				padding-right: 0.3rem;
			}
			
			.notice .leave_ul .leave_li .input.t_l {
				text-align: left;
			}
			
			.notice .leave_ul .leave_li .input.t_r {
				text-align: right;
			}
			
			.notice .leave_ul .leave_li .input.t_c {
				text-align: center;
			}
			
			.notice .leave_ul .leave_li .select {
				padding-right: 0.6rem;
				background: url(images/jian.png) no-repeat 93% 0.285rem;
				background-size: 0.22rem 0.38rem;
			}
			
			.cadre {
				display: none;
			}
			
			.notice .leave_ul .leave_li.cadre {
				display: none;
			}
			
			.notice .leave_ul.cadre {
				display: none;
			}
			/*审批人*/
			
			.isListBox {
				display: none;
				border-top: 1px solid #cccccc;
			}
			
			.isListBox .title {
				font-size: 0.375rem;
				color: #464646;
				text-align: center;
				height: auto;
				line-height: 1rem;
			}
			
			.isListBox .radio_box {
				width: 100%;
			}
			
			.isListBox .radio_box .radio_ul {
				width: 100%;
				overflow: hidden;
				list-style: none;
				margin: 0 auto;
				padding: 0rem;
			}
			
			.isListBox .radio_box .radio_ul li {
				width: 40%;
				margin: 0.2rem 5%;
				border-radius: 2em;
				background-color: #F0F0F0;
				color: #464646;
				text-align: center;
				list-style: none;
				float: left;
				height: 0.7rem;
				line-height: 0.7rem;
				font-size: 0.35rem;
				text-align: center;
			}
			
			.isListBox .radio_box .radio_ul li.active {
				background-color: #397AEF;
				color: #FFFFFF;
			}
			
			.isListBox .select_box {
				width: 100%;
			}
			
			.isListBox .select_box .select_ul {
				width: 100%;
				overflow: hidden;
				list-style: none;
				margin: 0 auto;
				padding: 0rem;
			}
			
			.isListBox .select_box .select_ul li {
				min-width: 30%;
				margin: 0.2rem 0.1rem;
				border-radius: 2em;
				background-color: #F0F0F0;
				color: #464646;
				text-align: center;
				list-style: none;
				float: left;
				height: 0.7rem;
				line-height: 0.7rem;
				font-size: 0.35rem;
				text-align: center;
				padding: 0 0.1rem;
			}
			
			.isListBox .select_box .select_ul li.active {
				background-color: #397AEF;
				color: #FFFFFF;
			}
			.type_box{
				height: 0.8rem;
				line-height: 0.8rem;
				padding: 0rem;
				margin: 0rem;
				display: block;
				overflow: hidden;
				border-top: 1px solid #dcdcdc;
				border-bottom: 1px solid #dcdcdc;
			}
			.type_box .span{
				background: #fff;
				border-bottom: 1px solid #dcdcdc;
				width: 50%;
				display: inline-block;
				color: #dcdcdc;
				font-size: 0.35rem;
				padding: 0rem;
				margin: 0rem;
				box-sizing: border-box;
				float: left;
				height: 100%;
			}
			.type_box .span:first-child{
				border-right: 1px solid #dcdcdc;
			}
			.type_box .span.active{
				color: #4178f9;
				font-weight: bold;
				border-bottom: 2px solid #4178f9;
				position: relative;
			}
		</style>
	</head>
	<body style="background: #f8f8f8">
		<div class="mui-content" style="margin-bottom: 1rem;">
			<div class="news leave_add">
				<p class="pp">
					<a><i class="iconfont icon-fanhui1 left mui-action-back"></a></i>新增工作动态
				</p>
				
				<div class="notice"> 
					<div class="gray" style="height: 0.2rem;"></div>
					<ul class="leave_ul">
						<li class="leave_li">
							<span class="left">姓名</span>
							<input class="input t_r" type="text" name="" id="travel_name" value="" readonly="readonly" placeholder="请填写" />
						</li>
						<li class="leave_li">
							<span class="left">职务</span>
							<input class="input t_r" type="text" name="" id="travel_duties" value="" readonly="readonly" placeholder="请填写" />
						</li>
					</ul>
					<div class="gray"></div>
					<ul class="leave_ul">
						<li class="leave_li">
							<span class="left">日期</span>
							<input class="input t_r" type="text" name="" id="travel_date" value="" placeholder="请选择" readonly="readonly"/>
						</li>
					</ul>
					<div class="gray zi">上午</div>
					<ul class="leave_ul" style="padding: 0;">
						<li class="leave_li" style="height: auto;padding: 0.2rem;">
							<textarea name="" id="travel_morning" rows="5" cols="" class="bgnr" style="margin: 0;padding: 0;display: block;padding: 0.2rem;" placeholder="请填写"></textarea>
						</li>
					</ul>
					<div class="gray zi">下午</div>
					<ul class="leave_ul" style="padding: 0;">
						<li class="leave_li" style="height: auto;padding: 0.2rem;">
							<textarea name="" id="travel_afternoon" rows="5" cols="" class="blqk" style="margin: 0;padding: 0;display: block;padding: 0.2rem;" placeholder="请填写"></textarea>
						</li>
					</ul>
					<button id="tijiao">提交</button>
				</div>
			</div>
		</div>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/mui.picker.min.js"></script>
		
		<script type="text/javascript">
			var root = localStorage.getItem("str_url");
			if(root == "" || root == undefined || root == null) {
				mui.openWindow({
					url: 'login.html?cid=1', //通过URL传参
					id: 'login.html?cid=1' //通过URL传参
				})
			}
			var token = localStorage.getItem("token");
			var dtpicker = new mui.DtPicker({
					"type": "date"
				});
				$("#travel_date").on("click",function(){
					dtpicker.show(function(items) {
						console.log(JSON.stringify(items));
						$('#travel_date').val(items.value);
						start_time = items.text;
						startat = items.text;
					});
				})
				
			function leaveType() {
				var _url = root + "api/logs/leaderinfor";
				mui.ajax(_url, {
					data: {
						"token": token
					},
					dataType: 'json', //服务器返回json格式数据
					type: 'post', //HTTP请求类型
					success: function(data) {
						if(data.code == 1) {
							var infor= data.data;
							$("#travel_name").val(infor.username);
							$("#travel_duties").val(infor.duty);
							$("#travel_date").val(infor.date);
						}else if(2<=data.code&&data.code<99){
							mui.openWindow({
								url: 'login.html?cid=1', //通过URL传参
								id: 'login.html?cid=1' //通过URL传参
							})
						}else{
							mui.toast(data.msg)
						}
					},
					error: function(xhr, type, errorThrown, data) {}
				})
			}
			leaveType();
			
			function tijiao_box(){
				var token = localStorage.getItem("token");
				var travel_date = $("#travel_date").val();
				var travel_morning = $("#travel_morning").val();
				var travel_afternoon = $("#travel_afternoon").val();
				var _url = root + "api/logs/newtrip";
				$.ajax({
					type: "POST",
					url: _url,
					data: {
						"token": token,
						"trip_date":travel_date, 					//行程日期
						"morning_trip":travel_morning,				//上午行程
						"afternoon_trip":travel_afternoon 			//下午行程
					},
					dataType: 'json', //服务器返回json格式数据
					beforeSend:function(){
						plus.nativeUI.showWaiting();
					},
					success: function(data) {
						if(data.code==1){
								var list = plus.webview.getWebviewById("travel_itinerary_list.html");
								mui.fire(list, 'refresh');
								plus.webview.currentWebview().close();
							mui.toast(data.msg);
						}else if(2<=data.code&&data.code<99){
							mui.openWindow({
								url: 'login.html?cid=1', //通过URL传参
								id: 'login.html?cid=1' //通过URL传参
							})
						}else{
							mui.toast(data.msg);
						}
						
					},
					error: function(data) {
						console.log("data失败返回值" + JSON.stringify(data))
					},
					complete:function(){
						plus.nativeUI.closeWaiting();
					}
				})
			
			}
			//提交
			$("#tijiao").on("click", tijiao_box)
			</script>
		<script src="js/isIphoneX.js" type="text/javascript" charset="utf-8"></script>
	</body>

</html>